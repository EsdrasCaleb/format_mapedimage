{"version":3,"file":"imagemap.min.js","sources":["../src/imagemap.js"],"sourcesContent":["export const init = (imageSource) => {\n    require(['jquery'], function($) { \n        var img = new Image();   // Create new img element\n        img.addEventListener(\n            \"load\",\n            () => {\n                var current_x = null\n                var current_y = null\n                var current_weigth = null\n                var current_heigth = null\n                var forma = null\n                var currentSelect = null\n\n                var newSelect = function(){\n                    currentSelect = $(this)\n                    forma = $(this).parent().next().children(\"select\").val()  \n                    current_heigth = $(this).parent().prev()\n                    current_weigth = current_heigth.prev()\n                    current_y = current_weigth.prev()\n                    current_x = current_y.prev()\n                } \n\n                var changeLink = function(){\n                        var pai = $(this).parent().next()\n                        console.log(pai)\n                        console.log(pai.children(\".section\"))\n                        console.log(pai.children(\".url\"))\n                        if(this.value==\"link\"){\n                            pai.children(\".section\").addClass(\"hidden\")\n                            pai.children(\".url\").removeClass(\"hidden\")\n                        }\n                        else{\n                            pai.children(\".url\").addClass(\"hidden\")\n                            pai.children(\".section\").removeClass(\"hidden\")\n                        }\n                }\n                $(\".rdSelect\").change(newSelect);\n                $(\".rdSelect\").click();\n                $(\".cmbForma\").change(()=>forma=this.value);\n                $(\".cmbTipo\").change(changeLink);\n                $(\"#btnAddMore\").click(function(){\n                    $(\"#containerAdd\").append('<div class=\"containers row\">'+\n                '<input type=\"hidden\" name=\"x[]\">'+\n                '<input type=\"hidden\" name=\"y[]\">'+\n                '<input type=\"hidden\" name=\"weigth[]\">'+\n                '<input type=\"hidden\" name=\"heigth[]\">'+\n                '<div class=\"col-2\">'+\n                    '<input type=\"radio\" name=\"selected[]\" class=\"rdSelect\" />'+\n                    'Selecionar'+\n                '</div>'+\n                '<div class=\"col-2\">'+\n                '<select class=\"cmbForma\" name=\"forma\">'+\n                    '<option value=\"rect\">Retangulo</option>'+\n                    '<option value=\"circle\">Circulo</option>'+\n                '</select>'+\n                '</div>'+\n                '<div class=\"col-2\">'+\n                    '<select class=\"cmbTipo\" name=\"tipo[]\">'+\n                        '<option value=\"link\">Link</option>'+\n                        '<option value=\"section\">Secao</option>'+\n                    '</select>'+\n                '</div>'+\n                '<div class=\"col-sm\">'+\n                    '<select class=\"section hidden\" name=\"sectuin[]\">'+\n                        '<option value=\"section\">section</option>'+\n                    '</select>'+\n                    '<input class=\"url\" name=\"url[]\" type=\"text\" value=\"\" />'+\n                '</div>'+\n                '<div class=\"col-1\">'+\n                '    <button class=\"btnRemove\">Remover</button>'+\n                '</div>'+\n            '</div>');\n                    $(\".containers:last .btnRemove\").click(function(){\n                        $(this).parent().parent().remove()\n                    })\n                    $(\".rdSelect\").off(\"change\")\n                    $(\".rdSelect\").change(newSelect)\n                    $(\".cmbForma\").off(\"change\")\n                    $(\".cmbForma\").change(()=>forma=this.value)\n                    $(\".cmbTipo\").off(\"change\")\n                    $(\".cmbTipo\").change(changeLink)\n                })\n\n                var imageWidth = img.naturalWidth; // this will be 1024 at max\n                var imageHeight = img.naturalHeight; // this will be 1024 at max\n                if(imageWidth>1024){\n                    imageHeight = (imageHeight*1024)/imageWidth;\n                    imageWidth = 1024;\n                }\n                $(\"#canvas\").attr(\"height\",imageHeight);\n                var canvas = document.getElementById(\"canvas\");\n                var ctx = canvas.getContext(\"2d\");\n                var canvasOffset = $(\"#canvas\").offset();\n                var offsetX = canvasOffset.left;\n                var offsetY = canvasOffset.top;\n                var startX;\n                var startY;\n                var isDown = false;\n                \n                //Desenha imagem\n                function drawImage(){\n                    ctx.drawImage(img, 0,0,imageWidth,imageHeight);\n                    $(\".rdSelect\").each(function(){\n                        if($(this)==currentSelect){\n                            return true;\n                        }\n                        var x =$(this).parent().prev().prev().prev().prev().val() \n                        var y = $(this).parent().prev().prev().prev().val()\n                        ctx.moveTo(x,y)\n                        if($(this).parent().next().children(\"select\").val() ==\"rect\"){  \n                            ctx.rect(x,y,\n                            $(this).parent().prev().prev().val(), \n                            $(this).parent().prev().val());\n\n                        }\n                        else{\n                            ctx.arc(x,y,\n                            $(this).parent().prev().val(),0, 2 * Math.PI);\n                        }\n                        ctx.stroke();\n                        ctx.globalAlpha = 0.5;\n                        ctx.fill();\n                        ctx.globalAlpha = 1;\n                    })\n                }\n\n                function drawCircle(x,y){\n                    ctx.globalAlpha = 1;\n                    ctx.clearRect(0, 0, canvas.width, canvas.height);\n                    drawImage();\n                    ctx.beginPath();\n                    ctx.moveTo(x,y)\n                    var coordx = startX+((x-startX)/2);\n                    var coordy = startY + ((y - startY) / 2);\n                    var rad = ( Math.sqrt( ((startX-x)*(startX-x)) + ((startY-y)*(startY-y)) ) )/2\n                    ctx.arc(coordx, coordy , rad,0, 2 * Math.PI);\n                    ctx.stroke();\n                    ctx.globalAlpha = 0.5;\n                    ctx.fill();\n                    current_heigth.val(rad)\n                    current_weigth.val(rad)\n                    current_y.val(coordy)\n                    current_x.val(coordx)\n                }\n\n                function drawRect(x,y){\n                    ctx.globalAlpha = 1;\n                    ctx.clearRect(0, 0, canvas.width, canvas.height);\n                    drawImage();\n                    ctx.moveTo(x,y);\n                    ctx.beginPath();\n                    var sizex = Math.abs(startX-x);\n                    var sizey = Math.abs(startY-y);\n                    var originx = startX>x?x:startX;\n                    var originy = startY>y?y:startY;\n                    ctx.rect(originx, originy, sizex, sizey);\n                    ctx.stroke();\n                    ctx.globalAlpha = 0.5;\n                    ctx.fill();\n                    current_heigth.val(sizey)\n                    current_weigth.val(sizex)\n                    current_y.val(originy)\n                    current_x.val(originx)\n                }\n\n                function handleMouseDown(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    startX = parseInt(e.clientX - offsetX);\n                    startY = parseInt(e.clientY - offsetY);\n                    isDown = true;\n                }\n\n                function handleMouseUp(e) {\n                    if (!isDown) {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    isDown = false;\n                }\n\n                function handleMouseOut(e) {\n                    if (!isDown) {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    isDown = false;\n                }\n\n                function handleMouseMove(e) {\n                    if (!isDown) {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    mouseX = parseInt(e.clientX - offsetX);\n                    mouseY = parseInt(e.clientY - offsetY);\n                    if(forma==\"rect\")\n                        drawRect(mouseX, mouseY);\n                    else\n                        drawCircle(mouseX, mouseY);\n                }\n\n                $(\"#canvas\").mousedown(function (e) {\n                    handleMouseDown(e);\n                });\n                $(\"#canvas\").mousemove(function (e) {\n                    handleMouseMove(e);\n                });\n                $(\"#canvas\").mouseup(function (e) {\n                    handleMouseUp(e);\n                });\n                $(\"#canvas\").mouseout(function (e) {\n                    handleMouseOut(e);\n                });\n                $(\"#page\").scroll(function(e){\n                    var BB=canvas.getBoundingClientRect();\n                    offsetX = BB.left;\n                    offsetY = BB.top;\n                })\n                drawImage();\n        });\n        img.src = imageSource;\n    });\n};"],"names":["_exports","init","imageSource","require","$","_this","this","img","Image","addEventListener","current_x","current_y","current_weigth","current_heigth","forma","currentSelect","newSelect","parent","next","children","val","prev","changeLink","pai","console","log","value","addClass","removeClass","change","click","_this2","append","remove","off","imageWidth","naturalWidth","imageHeight","naturalHeight","attr","startX","startY","canvas","document","getElementById","ctx","getContext","canvasOffset","offset","offsetX","left","offsetY","top","isDown","drawImage","each","x","y","moveTo","rect","arc","Math","PI","stroke","globalAlpha","fill","handleMouseMove","e","preventDefault","stopPropagation","mouseX","parseInt","clientX","mouseY","clientY","clearRect","width","height","beginPath","sizex","abs","sizey","originx","originy","drawRect","coordx","coordy","rad","sqrt","drawCircle","mousedown","handleMouseDown","mousemove","mouseup","handleMouseUp","mouseout","handleMouseOut","scroll","BB","getBoundingClientRect","src"],"mappings":"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"}